<!DOCTYPE html>
<html lang="en" data-ng-app="myApp">

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta id="version" name="version" content="<%= @appVersion %>" >
    <link href="apple-touch-icon.png" rel="apple-touch-icon-precomposed"/>
    <title>Imua</title>

    <%= csrf_meta_tags %>
    <%= stylesheet_link_tag "application", :media => "all" %>
    <%= javascript_include_tag "application" %>
    <%= favicon_link_tag 'favicon.ico' %>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width">

    <script type="text/javascript" src="//use.typekit.net/nck0oiv.js"></script>
    <!--<script type="text/javascript" src="//use.typekit.net/kmx1vmk.js"></script>-->
    <script type="text/javascript">try{Typekit.load();}catch(e){}</script>

    <base href="/app">
  </head>
  <body ng-controller="AppController">
    <div id="wrapper" ng-class="{'no-nav': hide_nav}">
      <!-- Nav -->
      <div ng-hide="hide_nav">
        <header id="sidebar-wrapper" ng-include="'navbar/navbar.html'"></header>
        <button type="button" id="menuToggle" class="btn btn-default">
          <span class="glyphicon glyphicon-align-justify"></span>
        </button>
      </div>
      <!-- Nav -->

      <div class="alerts-section">
        <alert ng-repeat="alert in alerts" type="{{alert.type}}" close="closeAlert($index)">{{alert.msg}}</alert>
      </div>

      <div id="page-content-wrapper" data-ng-view ng-if="!reload_required"></div>

      <div ng-if="reload_required" style="padding: 30px; text-align: center;">
        <h4>Oops! We recenty updated Imua and we noticed you are using an old version.</h4>
        <h5>Please refresh your browser window to get the updates!</h5>
      </div>
    </div>
  </body>

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', '<%= ENV["GA_TRACKING_ID"] %>',
    <% if ENV["RAILS_ENV"] == 'development' %>
      { 'cookieDomain': 'none'}
    <% else %>
      'auto'
    <% end %>
    );

    $(document).ready(function(){
      hideMenu();

      $("#menuToggle").click(function(e) {
          e.preventDefault();
          $("#wrapper").toggleClass("toggled");
      });



      $('.js-cog').click(function(){
        $('.js-submenu').toggle();

        $('.mask').toggle();
        $('.mask').height($(window).height());
        $('.mask').width($(window).width());
      });

      $('.js-nav-link').click(function(e) {
        hideMenu();

        e.stopPropagation();
      });

      $('.mask').click(function(e) {
        hideMenu();
        e.stopPropagation();
      })

      function hideMenu() {
        $('.js-submenu').hide();
        $('.mask').hide();
      }
      function checkWidth() {
        if ($(window).width() >= 768) {
            $('#wrapper').removeClass('toggled');
        }
      }

      $(window).resize(checkWidth);
    });
  </script>
</html>
