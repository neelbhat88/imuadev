<div ng-controller="TestingProgressController" class="testingProgressContainer" modulecolor="{{selected_module.module_title}}">

  <widget-teststaken></widget-teststaken>

  <widget-milestones></widget-milestones>

  <div class="module-container clear" modulecolor="{{selected_module.module_title}}">

    <div class="module module--tests">

      <div class="module--header">Tests Taken</div>

      <div class="module--content">

        <div class="module--no-data" ng-show="userTests.length == 0">
          <div ng-if="current_user.is_student">
            <h5>{{student.first_name}}, looks like you haven't added any tests yet.</h5>
            <p>If you've taken one recently, you should add it here!</p>
          </div>
          <div ng-if="!current_user.is_student">
            <h5>{{student.first_name}} hasn't added any tests this semester.</h5>
          </div>

        </div>

        <div class="module--data">

          <table ng-show="userTests.length > 0">
            <thead>
              <th>Date</th>
              <th>Test</th>
              <th colspan="2">Score</th>
            </thead>
            <tbody>
              <tr ng-repeat="userTest in userTests" ng-class="{'last':$last}">

                <td ng-hide="userTest.editing">{{userTest.date | formatMDY}}</td>
                <td ng-hide="userTest.editing">{{userTest.orgTest.title}}</td>
                <td ng-hide="userTest.editing">{{userTest.score}}</td>
                <td ng-hide="userTest.editing" class="glyphicons">
                  <div class="glyphicon-container">
                    <span class="glyphicon glyphicon-pencil" title="Edit Test" ng-click="editUserTest($index)"></span>
                    <span class="glyphicon glyphicon-trash" title="Delete Test" ng-click="deleteUserTest($index)"></span>
                  </div>
                </td>

                <td ng-show="userTest.editing" class="editing" colspan="4">
                  <span class="input-group">
                    <label>Date Taken:</label>
                    <imua-datepicker date="userTest.new_date"></imua-datepicker>
                  </span>
                  <span class="input-group">
                    <label>Test Taken:</label>
                    <select class="form-control" ng-options="orgTest as orgTest.title for orgTest in orgTests" ng-model="userTest.new_orgTest">
                      <option value="">--- Select Test ---</option>
                    </select>
                  </span>
                  <span ng-show="userTest.editing && userTest.new_orgTest.score_type != 'Letter Grade' && userTest.new_orgTest != null" class="input-group">
                    <label>Score:</label>
                    <input class="form-control" ng-model="userTest.new_score" placeholder="Score"></input>
                  </span>

                  <span ng-show="userTest.editing && userTest.new_orgTest.score_type == 'Letter Grade' && userTest.new_orgTest != null" class="input-group">
                    <label>Grade:</label>
                    <select class="form-control" ng-model="userTest.new_score">
                      <option value="A">A</option>
                      <option value="A-">A-</option>
                      <option value="B+">B+</option>
                      <option value="B">B</option>
                      <option value="B-">B-</option>
                      <option value="C+">C+</option>
                      <option value="C">C</option>
                      <option value="C-">C-</option>
                      <option value="D+">D+</option>
                      <option value="D">D</option>
                      <option value="D-">D-</option>
                      <option value="F">F</option>
                    </select>
                  </span>

                  <button class="submit" title="Confirm" ng-hide="!userTest.new_orgTest || !userTest.new_date" ng-click="saveUserTest($index)">Confirm</button>
                  <button class="cancel" title="Cancel" ng-click="cancelEditUserTest($index)">Cancel</button>

                </td>

              </tr>
            </tbody>
          </table>

          <button ng-if="editable(current_user, selected_semester)" class="btn btn-default" ng-click="addUserTest()" ng-hide="userTests.editing">Add Test</button>

        </div><!-- /module-data -->

      </div>

    </div><!-- /module--tests -->

    <div class="module module--tests-taken">

      <div class="module--header">Total Service Hours</div>

      <div class="module--content">

      	<div class="user-class-greeting" wait-to-load="{{loaded_module_milestones}}">
          <span ng-if="current_user.is_student">Hey {{student.first_name}}, you have completed</span>
          <span ng-if="!current_user.is_student">{{student.first_name}}, has completed</span>
          <h2>{{numUserTests}}</span></h2>
            <h4 ng-if="numUserTests != 1">Tests</h4>
            <h4 ng-if="numUserTests == 1">Test</h4>
            this semester.
        </div>

      </div>

    </div><!-- /module--tests-taken -->

  </div>

</div>
